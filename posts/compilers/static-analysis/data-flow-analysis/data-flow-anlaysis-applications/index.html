<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ã€è½¯ä»¶åˆ†æç¬”è®°ã€‘æ•°æ®æµåˆ†æï¼šåº”ç”¨ç¯‡ | åå£°ï¼Œåªæ˜¯ä¸€ç§ç³Ÿç³•çš„é”™è§‰</title><meta name=keywords content="static analysis"><meta name=description content="ä»‹ç»å…¸å‹çš„æ•°æ®æµåˆ†æç®—æ³•"><meta name=author content="Noobi"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><link rel=preload href=https://jiayezheng.tech/images/sl.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jiayezheng.tech/images/sl.png><link rel=icon type=image/png sizes=16x16 href=http://jiayezheng.tech/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://jiayezheng.tech/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://jiayezheng.tech/%3Clink%20resources/_gen/images/dio.webp%3E><link rel=mask-icon href=http://jiayezheng.tech/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.99.1"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=text/javascript async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"}),MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}})</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="ã€è½¯ä»¶åˆ†æç¬”è®°ã€‘æ•°æ®æµåˆ†æï¼šåº”ç”¨ç¯‡"><meta property="og:description" content="ä»‹ç»å…¸å‹çš„æ•°æ®æµåˆ†æç®—æ³•"><meta property="og:type" content="article"><meta property="og:url" content="http://jiayezheng.tech/posts/compilers/static-analysis/data-flow-analysis/data-flow-anlaysis-applications/"><meta property="og:image" content="http://jiayezheng.tech/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-09-15T11:30:03+00:00"><meta property="article:modified_time" content="2020-09-15T11:30:03+00:00"><meta property="og:site_name" content="åç°ä»£ä¸»ä¹‰ç”Ÿæ´»é»‘å®¢ ğŸ“š"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://jiayezheng.tech/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="ã€è½¯ä»¶åˆ†æç¬”è®°ã€‘æ•°æ®æµåˆ†æï¼šåº”ç”¨ç¯‡"><meta name=twitter:description content="ä»‹ç»å…¸å‹çš„æ•°æ®æµåˆ†æç®—æ³•"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://jiayezheng.tech/posts/"},{"@type":"ListItem","position":2,"name":"ã€è½¯ä»¶åˆ†æç¬”è®°ã€‘æ•°æ®æµåˆ†æï¼šåº”ç”¨ç¯‡","item":"http://jiayezheng.tech/posts/compilers/static-analysis/data-flow-analysis/data-flow-anlaysis-applications/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ã€è½¯ä»¶åˆ†æç¬”è®°ã€‘æ•°æ®æµåˆ†æï¼šåº”ç”¨ç¯‡","name":"ã€è½¯ä»¶åˆ†æç¬”è®°ã€‘æ•°æ®æµåˆ†æï¼šåº”ç”¨ç¯‡","description":"ä»‹ç»å…¸å‹çš„æ•°æ®æµåˆ†æç®—æ³•","keywords":["static analysis"],"articleBody":"Data Flow Analysisï¼šApplications Overview What is Data Flow Analysis ?\nHow application-specific Data flows on CFG with safe approximation.\nåˆ†æç®—æ³•æ„Ÿå…´è¶£çš„æ•°æ®å¦‚ä½•æµç»æ§åˆ¶æµå›¾ã€‚\n CFG  Nodes (Basic Blocks) åŸºæœ¬å— Edges (Control Flow) æ§åˆ¶æµ CFG(a program) æ•´ä¸ªç¨‹åº   Safe Approximation  safe approximation for different purposes ä¸åŒçš„åˆ†æç›®çš„ï¼Œå¯¹äºsafeæœ‰ä¸åŒçš„å®šä¹‰:\n Must Analysisï¼šUnder Approximation May Analysis: Over Approximation  ç›¸åŒç‚¹ï¼šè¿™ä¸¤ç§ç›®çš„å¾€å¾€æ®Šé€”åŒå½’åœ°è¾¾åˆ°Soundnessã€‚\nä¸åŒçš„ç›®çš„å¯¹åº”äº†ä¸åŒçš„æ‰‹æ®µï¼š1. Data Abstraction 2. Approximation Strategies i.e. transfer functions \u0026 control flow handling.\n Preliminaries for Data Flow Analysis Input \u0026 Output States Definition:\n$IN[s]\\ OUT[s]$ stand for input \u0026 output states of program points i.e. before and after executing the IR statements $s$ respectively.\ne.g.:\n ä¸‹é¢æ˜¯æœ€ç®€å•çš„ç¨‹åºç‚¹çš„ç¤ºæ„å›¾ã€‚åŒ…æ‹¬ï¼š  $s_1$çš„è¾“å…¥/è¾“å‡ºçŠ¶æ€ $s_1$çš„è¯­å¥ ç¨‹åºç‚¹ï¼ŒåŒ…æ‹¬çŠ¶æ€ä¿¡æ¯      è¯­å¥ä¹‹é—´çš„çŠ¶æ€å…³ç³»1ï¼š\nä¸‹é¢è¡¨ç¤ºä¸¤ä¸ªé¡ºåºçš„è¯­å¥ä¹‹é—´çŠ¶æ€å…³ç³»ã€‚\nå³ï¼Œ$s_2$çš„è¾“å…¥æ˜¯$s_1$çš„è¾“å‡º\n$IN[s_2]=OUT[s_1]$\n    å¸¦æœ‰æ§åˆ¶æµçš„è¯­å¥é—´çš„çŠ¶æ€å…³ç³»1ï¼š\nå³å›¾è¡¨ç¤ºäº†ä¸€ç§åˆ†æ”¯è¯­å¥çš„çŠ¶æ€å…³ç³»\n    å¸¦æœ‰æ§åˆ¶æµçš„è¯­å¥é—´çš„çŠ¶æ€å…³ç³»2ï¼š\nä¸‹å›¾æ˜¯åˆ†æ”¯åˆå¹¶è¯­å¥çš„çŠ¶æ€å…³ç³»ï¼Œå¼•å…¥äº†æ“ä½œç¬¦$\\wedge$ï¼Œè¡¨ç¤ºè¯­å¥åˆ†æ”¯çš„åˆå¹¶   Domain å€¼åŸŸ  In each data-flow analysis application, we associate with every program point a data-flow value that represents abstraction of the set of all possible program states that can be observed for that point.\n data-flow value: Abstraction of the set of all possible program states that can be observed for that point.\näºæ˜¯ï¼Œæˆ‘ä»¬æŠŠ data flow valueåœ¨ä¸€ä¸ªç¨‹åºä¸­å¯èƒ½å–å€¼çš„é›†åˆç§°ä½œ Domain.\nData flow analysis: another perspective Data-flow analysis is to find a solution to a set of safe-approximation-directed constraints on the $IN[s]$ and $OUT[s]$, for all statements $s$.\n constraints  transfer functions flow of control   solution  related data flow value for each program points of statement $s$.    Notations for Transfer Functionsâ€™s Constrains  Forward Analysis  $OUT[s] = f_s(IN[s])$\n Backward Analysis  $IN[s] = f_s(OUT[s])$\nNotations for Control Flowâ€™s Constraints   Control flow within a BB\n$IN[s_{i+1}]=OUT[s_i], \\forall i=1,2,3,â€¦,n-1$\n  Control flow among BBs\n$IN[B] = IN[s_1]$\n æ³¨ï¼šBBçš„å…¥å£æ˜¯BBç¬¬ä¸€ä¸ªè¯­å¥çš„å…¥å£\n $OUT[B]=OUT[s_n]$\n æ³¨ï¼šBBçš„å‡ºå£æ˜¯BBæœ€åä¸€ä¸ªè¯­å¥çš„å‡ºå£\n $OUT[B] = f_B(IN[B]), f_B = f_{sn} \\circ â€¦ \\circ f_{s2} \\circ f_{s1}$\n æ³¨ï¼š$\\circ$ è¡¨ç¤ºå‡½æ•°çš„å¤åˆ\n $IN[B]=\\bigwedge_{\\color{red}P\\\\ a\\ predecessor\\ of\\ \\color{blue} B}^{} OUT[P]$\n æ³¨ï¼šåˆ†æ”¯åˆå¹¶Bçš„è¾“å…¥ç­‰äºBæ‰€æœ‰å‰é©±èŠ‚ç‚¹è¾“å‡ºçŠ¶æ€ meet çš„ç»“æœ\n    Reaching Definitions Analysis Definition:\nA statement that assign a value to $v$. ä¸€æ¡å¯¹$v$çš„èµ‹å€¼è¯­å¥ã€‚\nReaching Definition:\n Definition of variable $v$ at program point $p$ reaches point $q$ if there is a path from p to $q$ s.t. no new definition of $v$ appears on that path.\n Reaching Definitionï¼šå˜é‡$v$åœ¨ä»ç¨‹åºç‚¹$p$åˆ°ç¨‹åºç‚¹ $q$åˆ°è¿‡ç¨‹ä¸­æœªè¢«é‡æ–°å®šä¹‰ã€‚\nåº”ç”¨   Detecting possible undefined variables. æ£€æŸ¥undefinedå˜é‡\nE.g.: Introduce a dummy definition for each variable. If any at point $p$, definition of variable $v$ is dummy, then it is undefined.\ne.g.: Application in Optimization: Check if the variable\n  Abstraction   Data Flow Values / Facts\n The definition of all the variables in a program. represented by Bit Vectors  e.g.: $D_1, D_2, D_3, â€¦, D_{100}$ (100 definitions)\n[ 0000...0 ]  Bit $i$ from the left represents definition $D_i$\n  Safe-Approximation è€ƒè™‘è¯­å¥ï¼š\nD: v = x op y æœ¬æ¡è¯­å¥å°†ç¨‹åºä¸­ $v$ çš„å…¶ä»–å®šä¹‰å»é™¤ï¼Œå…¶ä»–å˜é‡çš„å®šä¹‰ä¸å—å½±å“ã€‚\n  Transfer function æ•°å­¦è¯­è¨€è¡¨è¾¾\n$$OUT[B] = gen_B \\cup (IN[B] - kill_B)$$\nå…¶ä¸­$gen_B$åŸºæœ¬å—$B$äº§ç”Ÿçš„definitionçš„é›†åˆ\n$kill_B$ä»£è¡¨æ‰€æœ‰$B$ä»¥å¤–åŸºæœ¬å—å¯¹$B$å†…å˜é‡çš„æ›´æ”¹è¯­å¥çš„é›†åˆ\n  Control Flow\n æ˜¯ Forward Analysisï¼Œç®—æ³•ä»Entry è·‘åˆ°Exit ç”±äºæ˜¯ May Analysisï¼Œå› æ­¤ä¸ä¼šå¿½ç•¥ä»»æ„ä¸€ä¸ªåˆ†æ”¯  $$IN[B] = \\bigcup_{P\\ a\\ predecessor \\ of\\ B} OUT[P]$$\n  ä¸‹å›¾æ˜¯é¾™ä¹¦ä¸Š $gen_B$ å’Œ $kill_B$ çš„ä¾‹å­   Algorithm of Reaching Definition Analysis ç»ƒä¹ é¢˜  ç»ƒä¹ : å¯¹ä»¥ä¸‹CFGæ‰§è¡Œ **Reaching Definition Analysisï¼Œ**ç»™å‡ºæœ€ç»ˆçš„$IN$å’Œ$OUT$  Understanding the why the loop will definitely stop ï¼ˆç†è§£ç®—æ³•çš„æ”¶æ•›æ€§ï¼‰   $gen_s$ å’Œ $kill_s$ æ˜¯å¸¸é‡\n  $IN[s]$ æ¯æ¬¡å¢åŠ çš„å› å­factorï¼ˆè¿™é‡ŒæŒ‡Definitionï¼‰è¦ä¹ˆè¢«$kill_s$ è¦ä¹ˆè¢«å¸¦å…¥$OUT[s]$\n   äºæ˜¯$OUT[s]=f_s(IN[s])$ å•è°ƒä¸å‡ ($OUT[s]$è¦ä¹ˆ0â†’1ï¼Œ è¦ä¹ˆ 1â†’1 ) åˆç”±äºfactoræœ¬èº«æ˜¯æœ‰é™çš„ i.e. OUT[s]æœ€å¤šå˜æˆ 1111â€¦1111 å°±ä¸å˜äº†ã€‚ ç±»æ¯”ä¸€ä¸‹æ•°åˆ—çš„å•è°ƒæœ‰ç•Œå‡†åˆ™ã€‚  Understanding the safe-approximation ï¼ˆç†è§£ç®—æ³•å®‰å…¨è¿‘ä¼¼æ€§ï¼‰   å½“$OUT[s]$ä¸å†å˜åŒ–æ—¶ï¼Œ$IN[s]$æ˜¯å¦ä¼šå†æ¬¡å˜åŒ–ï¼Ÿ\nç­”æ¡ˆæ˜¯ä¸ä¼šï¼Œç”±äº\n$IN[B] = \\bigcup_{P\\ a\\ predecessor \\ of\\ B} OUT[P]$\næ‰€æœ‰çš„$IN[B]$ å–å†³äº $OUT[P]$ çš„å€¼ï¼Œäºæ˜¯$IN[B]$çš„å€¼ä¸å˜ã€‚\n$OUT[B] = gen_B \\cup (IN[B] - kill_B)$\näºæ˜¯æ‰€æœ‰çš„ $OUT[s]$ä¹Ÿä¸ä¼šæ”¹å˜ã€‚\n  ç»ƒä¹ ï¼šå¯¹ä»¥ä¸‹CFGï¼Œåˆ©ç”¨Reaching Definition Analysisï¼Œè®¡ç®—å„ä¸ªBBæœ€ç»ˆçš„$IN$å’Œ$OUT$\n Live Variable Analysis Definition:  Live variable analysis tells whether the value of variable $v$ at program point $p$ could be used along some path in CFG starting at $p$. If so, $v$ is live at $p$ï¼›otherwiseï¼Œ$v$ is dead at $p$.\n (è¿™ä¹Ÿæ„å‘³ç€ï¼š$v$ should not be redefined before usage)\n Applicationï¼š  Register Allocation (å¯„å­˜å™¨åˆ†é…ï¼‰    Abstraction  Data Flow Values/Facts  All the variables in a program Can be represented by bit vectors  0: dead 1: live      Safe-Approximation   why forward analysis is not appropriate for live variable analysis?\n Assume we use forward analysis strategy, information of using should be propagate backward whenever a statement use $v$ is reached, which costs a lot. æˆ‘ä»¬åˆ©ç”¨åè¯æ³•çš„æ€æƒ³ï¼šå‡è®¾æˆ‘ä»¬ä½¿ç”¨å‰å‘åˆ†æï¼Œå˜é‡ä½¿ç”¨çš„ä¿¡æ¯å°†ä¼šè¢«å‘åä¼ æ’­ï¼Œé‚£è¿˜ä¸å¦‚ç›´æ¥è¿›è¡Œåå‘åˆ†ææ¥çš„æ–¹ä¾¿ã€‚    According to the definition, the live variable should be a may analysis.\n  understand the term â€˜liveâ€™: determine whether the variable $v$ in some register $R$ is live, or should we delete the value of $v$ in $R$, at the point of $IN[B]$?\nIf Yes, $IN[B] = {v}$ else $IN[B] = {}$\n  ç”±äºæ˜¯may analysisï¼ŒControl Flowé€šè¿‡ä»¥ä¸‹å¼å­ç»™å‡º\n$$ OUT[B] = \\bigcup_{S\\ is\\ a successor\\ of\\ B} IN[S] $$\n  ç›²äººæ‘¸è±¡ï¼šæˆ‘ä»¬é€šè¿‡ä»¥ä¸‹ä¸€ç»„ç»ƒä¹ ï¼Œæ¢ç´¢æ‰€æœ‰Bå…³äº$v$çš„è¡¨è¾¾å¼ä¹‹æƒ…å†µï¼Œæ¥æ¢ç´¢å‡º Transfer Function\nç»ƒä¹ ï¼šæ ¹æ®ä¸Šå›¾çš„CFGï¼Œå¹¶ç»™å®š$OUT[B] = {v}$ï¼Œè€ƒè™‘ä»¥ä¸‹$B$çš„è¡¨è¾¾å¼å¯¹åº”çš„$IN[B]$\n k = n 2. k = v 3. v = v - 1 4. v = 2; k = v 5. k = v; v = 2 6. v = 2    *ç­”æ¡ˆï¼š\n k = n: ç”±äºæ²¡æœ‰æ¶‰åŠåˆ°$v$ï¼Œæ ¹æ®åŸåˆ™ï¼Œå¯„å­˜å™¨$R$ä¸åº”åˆ å»$v$çš„å€¼ï¼Œå› æ­¤$IN[B] = {v}$ k = v : ç”±äºæ¶‰åŠåˆ°use $v$ï¼Œæˆ‘ä»¬ä¸åº”è¯¥åˆ å»$v$çš„å€¼ï¼Œå› æ­¤$IN[B] = {v}$ v = v - 1 : è¿™é¢˜çœ‹ä¼¼æ˜¯å¯¹ $v$è¿›è¡Œäº†æ–°çš„å®šä¹‰ï¼Œä½†æ˜¯å°±è¯­ä¹‰è€Œè¨€ï¼Œå°†ä¼šå…ˆå¯¹$v$çš„æ—§å€¼è¿›è¡Œè¯»å–ï¼Œäºæ˜¯æˆ‘ä»¬æ²¡æœ‰å¿…è¦ kill æ‰$v$ï¼Œå› æ­¤ $IN[B] = {v}$ v = 2; k = v ï¼šè¿™é¢˜çœ‹ä¼¼ä½¿ç”¨äº† $v$ï¼Œä½†æ˜¯å…ˆkillæ‰äº†$v$çš„å®šä¹‰ï¼Œå› æ­¤ $IN[B] = {}$ k = v; v = 2 ï¼š*æ­£å¥½ä¸ä¸Šé¢˜ç›¸åï¼Œå…ˆå¯¹$v$è¿›è¡Œäº†useï¼Œå› æ­¤$IN[B] = {v}$ v = 2 ï¼š$v$è¢«killæ‰ï¼Œæ˜¾ç„¶ $IN[b] = {v}$    å…ˆæ¥å›ç­”é›†åˆä¸­é‚£äº›å¢å‡çš„é‡\n $use_B$ï¼šé›†åˆä¸­åœ¨ä»»ä½•useå…ˆäºdefineçš„å˜é‡é›†åˆã€‚ $def_B$ï¼šé›†åˆä¸­ä»»ä½•defineå…ˆäºuseçš„å˜é‡é›†åˆã€‚    äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ‘¸ç´¢å‡ºä¸€ä¸ª Transfer Function\n$$ IN[B] = use_B \\cup(OUT[B]-def_B) $$\n  æ€è€ƒï¼škill $def_B$ å’Œ union $use_B$ çš„é¡ºåºæ˜¯å¦å½±å“ç®—æ³•çš„æ­£ç¡®æ€§ï¼Ÿ\nç»“è®ºï¼šä¸å½±å“ï¼Œç›´è§‰ä¸Šæ¥çœ‹ï¼Œæ ¹æ®$def_B$å’Œ$use_B$çš„å®šä¹‰ï¼Œ$def_B \\cap use_b = \\phi$\nä¸å¤±ä¸¥è°¨åœ°ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜è¿™ä¸ªæ€§è´¨ï¼š\nã€æ¨è®ºã€‘\nå·²çŸ¥ $def_B \\cap use_b = \\phi$ï¼Œ $IN[B] = use_B \\cup(OUT[B]-def_B) = (OUT[B] \\cup use_B) - def_B$ æˆç«‹\nã€è¯æ˜ã€‘\nè€ƒè™‘é›†åˆè¿ç®—å…¬å¼ï¼š $(B-A) \\cup C = (B\\cup C) - (A - C)$\næˆ‘ä»¬æœ‰ï¼š\n$$ IN[B] = use_B \\cup(OUT[B]-def_B) = (use_B \\cup OUT[B]) - (def_B - use_B) $$\nç”±äº $def_B \\cap use_b = \\phi$ï¼Œäºæ˜¯æœ‰$def_B-use_B =def_B$\né‚£ä¹ˆï¼Œ\n$$ (use_B \\cup OUT[B]) - (def_B - use_B)=(use_B \\cup OUT[B]) - def_B $$\n$\\blacksquare$\n  Algorithm æŒ‰ç…§Reaching Definition Analysisçš„æ¡†æ¶ï¼Œä¸éš¾å¾—åˆ°ã€‚ä½†æ˜¯æœ‰ä¸€ç‚¹ä¸åŒï¼š\nç”±äºæ˜¯BackWard Analysisï¼Œä»ExitèŠ‚ç‚¹å¼€å§‹éå†ã€‚\nç»ƒä¹ é¢˜  ç»ƒä¹ : å¯¹ä»¥ä¸‹CFGæ‰§è¡Œ **Reaching Definition Analysisï¼Œ**ç»™å‡ºæœ€ç»ˆçš„$IN$å’Œ$OUT$   Available Expression Analysis Definition Available:\nAn expression x op y is available at program point $p$ if\n All paths from the entry to p must pass through the evaluation of x op y After the last evaluation of x op y, there is no redefinition of x or y  Explanation:\n è¿™é‡Œçš„redefinitionè¡¨æ˜ï¼šåŸæœ¬çš„ç»“æœå¤±æ•ˆï¼Œæˆ‘ä»¬å¯ä»¥éœ€è¦æ›´æ”¹ x op y çš„ç»“æœå€¼ available expressionçš„ä¿¡æ¯å¯ä»¥ç”¨äºæ£€æŸ¥å…¨å±€ç›¸åŒçš„å­è¡¨è¾¾å¼  æ¯”å¦‚ï¼Œåœ¨æŸå‡ ä¸ªBBä¸­è¡¨è¾¾å¼çš„å€¼ä¸å˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ å»é‚£ä¸ªè¡¨è¾¾å¼ï¼Œç›´æ¥å°†ç¼“å­˜çš„ç»“æœèµ‹ç»™å˜é‡ï¼Œä¼˜åŒ–æ‰é‡å¤è®¡ç®—ã€‚    Abstraction  All the expressions in a program Also represented by Bit Vectors  Safe-Approximation æ³¨ï¼š\n As the definition illustrated, the available expression analysis ought to be a MUST ANALYSIS. As we are analyzing expression in all control flows, forward analysis is preferred to bring the information.  Transfer Function\n$gen_B$: Any expression included by $B$ to be involved.\n$kill_B$: Any expression contains variables redefined in $B$ to be excluded.\næˆ‘ä»¬å¯ä»¥å¾—åˆ°Transfer Functionï¼š\n$$ OUT[B] = gen_B \\cup (IN[B]-kill_B) $$\nControl Flows\nFor it is a must analysis, control flow ought to defined by:\n$$ IN[B] = \\bigcap_{P\\ predecessor\\ of\\ B } OUT[P] $$\nAlgorithm  ç»ƒä¹ : å¯¹ä»¥ä¸‹CFGæ‰§è¡Œ **Reaching Definition Analysisï¼Œ**ç»™å‡ºæœ€ç»ˆçš„$IN$å’Œ$OUT$   Comparison for three data flow analysis ç»ƒä¹ ï¼šæ ¹æ®ä»¥ä¸Šçš„å†…å®¹ï¼Œå¡«å†™ä¸‹è¡¨ï¼ˆä¸è¦å‚è€ƒä¸Šé¢çš„ææ–™ï¼‰\n ç­”æ¡ˆï¼š  ","wordCount":"1049","inLanguage":"en","datePublished":"2020-09-15T11:30:03Z","dateModified":"2020-09-15T11:30:03Z","author":{"@type":"Person","name":"Noobi"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://jiayezheng.tech/posts/compilers/static-analysis/data-flow-analysis/data-flow-anlaysis-applications/"},"publisher":{"@type":"Organization","name":"åå£°ï¼Œåªæ˜¯ä¸€ç§ç³Ÿç³•çš„é”™è§‰","logo":{"@type":"ImageObject","url":"https://jiayezheng.tech/images/sl.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://jiayezheng.tech/ accesskey=h title="åå£°ï¼Œåªæ˜¯ä¸€ç§ç³Ÿç³•çš„é”™è§‰ (Alt + H)"><img src=https://jiayezheng.tech/images/sl.png alt=logo aria-label=logo height=35>åå£°ï¼Œåªæ˜¯ä¸€ç§ç³Ÿç³•çš„é”™è§‰</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=http://jiayezheng.tech/aboutme/ title=å…³äºæˆ‘><span>å…³äºæˆ‘</span></a></li><li><a href=http://jiayezheng.tech/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://jiayezheng.tech/ title=ä¸»é¡µ><span>ä¸»é¡µ</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://jiayezheng.tech/>Home</a>&nbsp;Â»&nbsp;<a href=http://jiayezheng.tech/posts/>Posts</a></div><h1 class=post-title>ã€è½¯ä»¶åˆ†æç¬”è®°ã€‘æ•°æ®æµåˆ†æï¼šåº”ç”¨ç¯‡</h1><div class=post-description>ä»‹ç»å…¸å‹çš„æ•°æ®æµåˆ†æç®—æ³•</div><div class=post-meta><span title="2020-09-15 11:30:03 +0000 UTC">September 15, 2020</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;Noobi&nbsp;|&nbsp;<a href=https://github.com/Xpectuer/my-blog/content/posts/compilers/static-analysis/data-flow-analysis/data-flow-anlaysis-applications.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#data-flow-analysisapplications aria-label="Data Flow Analysisï¼šApplications">Data Flow Analysisï¼šApplications</a><ul><li><a href=#overview aria-label=Overview>Overview</a></li><li><a href=#preliminaries-for-data-flow-analysis aria-label="Preliminaries for Data Flow Analysis">Preliminaries for Data Flow Analysis</a><ul><li><a href=#input--output-states aria-label="Input &amp;amp; Output States">Input & Output States</a></li><li><a href=#domain-%e5%80%bc%e5%9f%9f aria-label="Domain å€¼åŸŸ">Domain å€¼åŸŸ</a></li><li><a href=#data-flow-analysis-another-perspective aria-label="Data flow analysis: another perspective">Data flow analysis: another perspective</a></li><li><a href=#notations-for-transfer-functionss-constrains aria-label="Notations for Transfer Functionsâ€™s Constrains">Notations for Transfer Functionsâ€™s Constrains</a></li><li><a href=#notations-for-control-flows-constraints aria-label="Notations for Control Flowâ€™s Constraints">Notations for Control Flowâ€™s Constraints</a></li></ul></li><li><a href=#reaching-definitions-analysis aria-label="Reaching Definitions Analysis">Reaching Definitions Analysis</a><ul><li><a href=#%e5%ba%94%e7%94%a8 aria-label=åº”ç”¨>åº”ç”¨</a></li><li><a href=#abstraction aria-label=Abstraction>Abstraction</a></li><li><a href=#safe-approximation aria-label=Safe-Approximation>Safe-Approximation</a></li><li><a href=#algorithm-of-reaching-definition-analysis aria-label="Algorithm of Reaching Definition Analysis">Algorithm of Reaching Definition Analysis</a></li><li><a href=#%e7%bb%83%e4%b9%a0%e9%a2%98 aria-label=ç»ƒä¹ é¢˜>ç»ƒä¹ é¢˜</a></li><li><a href=#understanding-the-why-the-loop-will-definitely-stop-%e7%90%86%e8%a7%a3%e7%ae%97%e6%b3%95%e7%9a%84%e6%94%b6%e6%95%9b%e6%80%a7 aria-label="Understanding the why the loop will definitely stop ï¼ˆç†è§£ç®—æ³•çš„æ”¶æ•›æ€§ï¼‰">Understanding the why the loop will definitely stop ï¼ˆç†è§£ç®—æ³•çš„æ”¶æ•›æ€§ï¼‰</a></li><li><a href=#understanding-the-safe-approximation-%e7%90%86%e8%a7%a3%e7%ae%97%e6%b3%95%e5%ae%89%e5%85%a8%e8%bf%91%e4%bc%bc%e6%80%a7 aria-label="Understanding the safe-approximation ï¼ˆç†è§£ç®—æ³•å®‰å…¨è¿‘ä¼¼æ€§ï¼‰">Understanding the safe-approximation ï¼ˆç†è§£ç®—æ³•å®‰å…¨è¿‘ä¼¼æ€§ï¼‰</a></li></ul></li><li><a href=#live-variable-analysis aria-label="Live Variable Analysis">Live Variable Analysis</a><ul><li><a href=#definition aria-label=Definition:><strong>Definition:</strong></a></li><li><a href=#abstraction-1 aria-label=Abstraction><strong>Abstraction</strong></a></li><li><a href=#safe-approximation-1 aria-label=Safe-Approximation><strong>Safe-Approximation</strong></a></li><li><a href=#algorithm aria-label=Algorithm>Algorithm</a></li><li><a href=#%e7%bb%83%e4%b9%a0%e9%a2%98-1 aria-label=ç»ƒä¹ é¢˜>ç»ƒä¹ é¢˜</a></li></ul></li><li><a href=#available-expression-analysis aria-label="Available Expression Analysis">Available Expression Analysis</a><ul><li><a href=#definition-1 aria-label=Definition>Definition</a></li><li><a href=#abstraction-2 aria-label=Abstraction>Abstraction</a></li><li><a href=#safe-approximation-2 aria-label=Safe-Approximation>Safe-Approximation</a></li><li><a href=#algorithm-1 aria-label=Algorithm>Algorithm</a></li><li><a href=#comparison-for-three-data-flow-analysis aria-label="Comparison for three data flow analysis">Comparison for three data flow analysis</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=data-flow-analysisapplications>Data Flow Analysisï¼šApplications<a hidden class=anchor aria-hidden=true href=#data-flow-analysisapplications>#</a></h1><h2 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h2><p>What is <em>Data Flow Analysis</em> ?</p><p>How application-specific Data flows on <strong>CFG</strong> with <strong>safe approximation</strong>.</p><p>åˆ†æç®—æ³•æ„Ÿå…´è¶£çš„æ•°æ®å¦‚ä½•æµç»æ§åˆ¶æµå›¾ã€‚</p><ul><li><strong>CFG</strong><ul><li>Nodes (Basic Blocks) åŸºæœ¬å—</li><li>Edges (Control Flow) æ§åˆ¶æµ</li><li>CFG(a program) æ•´ä¸ªç¨‹åº</li></ul></li><li>Safe Approximation</li></ul><p>safe approximation for <strong>different purposes ä¸åŒçš„åˆ†æç›®çš„ï¼Œå¯¹äºsafeæœ‰ä¸åŒçš„å®šä¹‰</strong>:</p><ul><li>Must Analysisï¼šUnder Approximation</li><li>May Analysis: Over Approximation</li></ul><p><strong>ç›¸åŒç‚¹</strong>ï¼šè¿™ä¸¤ç§ç›®çš„å¾€å¾€æ®Šé€”åŒå½’åœ°è¾¾åˆ°Soundnessã€‚</p><p>ä¸åŒçš„ç›®çš„å¯¹åº”äº†ä¸åŒçš„æ‰‹æ®µï¼š1. Data Abstraction 2. Approximation Strategies i.e. <strong>transfer functions</strong> & <strong>control flow handling</strong>.</p><hr><h2 id=preliminaries-for-data-flow-analysis>Preliminaries for Data Flow Analysis<a hidden class=anchor aria-hidden=true href=#preliminaries-for-data-flow-analysis>#</a></h2><h3 id=input--output-states>Input & Output States<a hidden class=anchor aria-hidden=true href=#input--output-states>#</a></h3><p><strong>Definition</strong>:</p><p>$IN[s]\ OUT[s]$ stand for input & output states of program points i.e. before and after executing the IR statements $s$ respectively.</p><p>e.g.:</p><ul><li>ä¸‹é¢æ˜¯æœ€ç®€å•çš„ç¨‹åºç‚¹çš„ç¤ºæ„å›¾ã€‚åŒ…æ‹¬ï¼š<ol><li>$s_1$çš„è¾“å…¥/è¾“å‡ºçŠ¶æ€</li><li>$s_1$çš„è¯­å¥</li><li>ç¨‹åºç‚¹ï¼ŒåŒ…æ‹¬çŠ¶æ€ä¿¡æ¯</li></ol></li></ul><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_5B9834796776-1.jpeg alt=IMG_5B9834796776-1.jpeg style=zoom:50%><ul><li><p>è¯­å¥ä¹‹é—´çš„çŠ¶æ€å…³ç³»1ï¼š</p><p>ä¸‹é¢è¡¨ç¤ºä¸¤ä¸ªé¡ºåºçš„è¯­å¥ä¹‹é—´çŠ¶æ€å…³ç³»ã€‚</p><p>å³ï¼Œ$s_2$çš„è¾“å…¥æ˜¯$s_1$çš„è¾“å‡º</p><p>$IN[s_2]=OUT[s_1]$</p></li></ul><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_1264.jpg alt=IMG_1264.jpg style=zoom:50%><ul><li><p>å¸¦æœ‰æ§åˆ¶æµçš„è¯­å¥é—´çš„çŠ¶æ€å…³ç³»1ï¼š</p><p>å³å›¾è¡¨ç¤ºäº†ä¸€ç§åˆ†æ”¯è¯­å¥çš„çŠ¶æ€å…³ç³»</p></li></ul><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_39DFBE1DA174-1.jpeg alt=IMG_39DFBE1DA174-1.jpeg style=zoom:50%><ul><li><p>å¸¦æœ‰æ§åˆ¶æµçš„è¯­å¥é—´çš„çŠ¶æ€å…³ç³»2ï¼š</p><p>ä¸‹å›¾æ˜¯åˆ†æ”¯åˆå¹¶è¯­å¥çš„çŠ¶æ€å…³ç³»ï¼Œå¼•å…¥äº†æ“ä½œç¬¦$\wedge$ï¼Œè¡¨ç¤ºè¯­å¥åˆ†æ”¯çš„åˆå¹¶
<img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_1266.jpg alt=IMG_1266.jpg style=zoom:50%></p></li></ul><h3 id=domain-å€¼åŸŸ>Domain å€¼åŸŸ<a hidden class=anchor aria-hidden=true href=#domain-å€¼åŸŸ>#</a></h3><blockquote><p>In each data-flow analysis application, we associate with every program point a data-flow value that represents abstraction of the set of all possible program states that can be observed for that point.</p></blockquote><p>data-flow value: <strong>Abstraction</strong> of the set of all possible <strong>program states</strong> that can be observed for that point.</p><p>äºæ˜¯ï¼Œæˆ‘ä»¬æŠŠ data flow valueåœ¨ä¸€ä¸ªç¨‹åºä¸­å¯èƒ½å–å€¼çš„é›†åˆç§°ä½œ <strong>Domain.</strong></p><h3 id=data-flow-analysis-another-perspective>Data flow analysis: another perspective<a hidden class=anchor aria-hidden=true href=#data-flow-analysis-another-perspective>#</a></h3><p>Data-flow analysis is to find a solution to a set of safe-approximation-directed constraints on the $IN[s]$ and $OUT[s]$, for all statements $s$.</p><ul><li>constraints<ul><li>transfer functions</li><li>flow of control</li></ul></li><li>solution<ul><li>related data flow value for each program points of statement $s$.</li></ul></li></ul><h3 id=notations-for-transfer-functionss-constrains>Notations for Transfer Functionsâ€™s Constrains<a hidden class=anchor aria-hidden=true href=#notations-for-transfer-functionss-constrains>#</a></h3><ul><li><strong>Forward Analysis</strong></li></ul><p>$OUT[s] = f_s(IN[s])$</p><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_6B0F10640944-1.jpeg alt=IMG_6B0F10640944-1.jpeg style=zoom:50%><ul><li><strong>Backward Analysis</strong></li></ul><p>$IN[s] = f_s(OUT[s])$</p><h3 id=notations-for-control-flows-constraints>Notations for Control Flowâ€™s Constraints<a hidden class=anchor aria-hidden=true href=#notations-for-control-flows-constraints>#</a></h3><ul><li><p><strong>Control flow within a BB</strong></p><p>$IN[s_{i+1}]=OUT[s_i], \forall i=1,2,3,&mldr;,n-1$</p></li><li><p><strong>Control flow among BBs</strong></p><p>$IN[B] = IN[s_1]$</p><blockquote><p>æ³¨ï¼šBBçš„å…¥å£æ˜¯BB<strong>ç¬¬ä¸€ä¸ªè¯­å¥</strong>çš„<strong>å…¥å£</strong></p></blockquote><p>$OUT[B]=OUT[s_n]$</p><blockquote><p>æ³¨ï¼šBBçš„å‡ºå£æ˜¯BB<strong>æœ€åä¸€ä¸ªè¯­å¥</strong>çš„<strong>å‡ºå£</strong></p></blockquote><p>$OUT[B] = f_B(IN[B]), f_B = f_{sn} \circ &mldr; \circ f_{s2} \circ f_{s1}$</p><blockquote><p>æ³¨ï¼š$\circ$ è¡¨ç¤ºå‡½æ•°çš„å¤åˆ</p></blockquote><p>$IN[B]=\bigwedge_{\color{red}P\\ a\ predecessor\ of\ \color{blue} B}^{} OUT[P]$</p><blockquote><p>æ³¨ï¼šåˆ†æ”¯åˆå¹¶Bçš„è¾“å…¥ç­‰äºBæ‰€æœ‰å‰é©±èŠ‚ç‚¹è¾“å‡ºçŠ¶æ€ <strong>meet çš„ç»“æœ</strong></p></blockquote></li></ul><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_D7917E87C141-1.jpeg alt=IMG_D7917E87C141-1.jpeg style=zoom:50%>
<img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_2BDB7DCE680A-1.jpeg alt=IMG_2BDB7DCE680A-1.jpeg style=zoom:50%><hr><h2 id=reaching-definitions-analysis>Reaching Definitions Analysis<a hidden class=anchor aria-hidden=true href=#reaching-definitions-analysis>#</a></h2><p><strong>Definition:</strong></p><p>A statement that assign a value to $v$. ä¸€æ¡å¯¹$v$çš„èµ‹å€¼è¯­å¥ã€‚</p><p><strong>Reaching Definition:</strong></p><blockquote><p>Definition of variable $v$ at program point $p$ reaches point $q$ if there is a path from p to $q$ s.t. <strong>no new definition of</strong> $v$ appears on that path.</p></blockquote><p><strong>Reaching Definition</strong>ï¼šå˜é‡$v$åœ¨ä»ç¨‹åºç‚¹$p$åˆ°ç¨‹åºç‚¹ $q$åˆ°è¿‡ç¨‹ä¸­æœªè¢«é‡æ–°å®šä¹‰ã€‚</p><h3 id=åº”ç”¨>åº”ç”¨<a hidden class=anchor aria-hidden=true href=#åº”ç”¨>#</a></h3><ul><li><p>Detecting possible undefined variables. æ£€æŸ¥undefinedå˜é‡</p><p>E.g.: Introduce a <strong>dummy definition</strong> for each variable. If any at point $p$, definition of variable $v$ is dummy, then it is <strong>undefined</strong>.</p><p>e.g.: Application in Optimization: Check if the variable</p></li></ul><h3 id=abstraction>Abstraction<a hidden class=anchor aria-hidden=true href=#abstraction>#</a></h3><ul><li><p>Data Flow Values / Facts</p><ul><li>The definition of all the variables in a program.</li><li>represented by <strong>Bit Vectors</strong></li></ul><p>e.g.: $D_1, D_2, D_3, &mldr;, D_{100}$ (100 definitions)</p><pre><code>[ 0000...0 ] &lt;â€”â€”(100 bits)
</code></pre><p>Bit $i$ from the left represents definition $D_i$</p></li></ul><h3 id=safe-approximation>Safe-Approximation<a hidden class=anchor aria-hidden=true href=#safe-approximation>#</a></h3><p>è€ƒè™‘è¯­å¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>D: v <span style=color:#f92672>=</span> x op y
</span></span></code></pre></div><p>æœ¬æ¡è¯­å¥å°†ç¨‹åºä¸­ $v$ çš„å…¶ä»–å®šä¹‰<strong>å»é™¤</strong>ï¼Œå…¶ä»–å˜é‡çš„å®šä¹‰ä¸å—å½±å“ã€‚</p><ul><li><p><strong>Transfer function æ•°å­¦è¯­è¨€è¡¨è¾¾</strong></p><p>$$OUT[B] = gen_B \cup (IN[B] - kill_B)$$</p><p>å…¶ä¸­$gen_B$åŸºæœ¬å—$B$äº§ç”Ÿçš„definitionçš„<strong>é›†åˆ</strong></p><p>$kill_B$ä»£è¡¨æ‰€æœ‰$B$ä»¥å¤–åŸºæœ¬å—å¯¹$B$å†…å˜é‡çš„æ›´æ”¹è¯­å¥çš„<strong>é›†åˆ</strong></p></li><li><p><strong>Control Flow</strong></p><ul><li>æ˜¯ Forward Analysisï¼Œç®—æ³•ä»Entry è·‘åˆ°Exit</li><li>ç”±äºæ˜¯ May Analysisï¼Œå› æ­¤ä¸ä¼šå¿½ç•¥ä»»æ„ä¸€ä¸ªåˆ†æ”¯</li></ul><p>$$IN[B] = \bigcup_{P\ a\ predecessor \ of\ B} OUT[P]$$</p></li><li><p>ä¸‹å›¾æ˜¯é¾™ä¹¦ä¸Š $gen_B$ å’Œ $kill_B$ çš„ä¾‹å­
<img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_C1B6C8D6DC93-1.jpeg alt=IMG_C1B6C8D6DC93-1.jpeg style=zoom:50%></p></li></ul><h3 id=algorithm-of-reaching-definition-analysis>Algorithm of Reaching Definition Analysis<a hidden class=anchor aria-hidden=true href=#algorithm-of-reaching-definition-analysis>#</a></h3><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/reaching_def.png alt="reaching definition algorithm"><h3 id=ç»ƒä¹ é¢˜>ç»ƒä¹ é¢˜<a hidden class=anchor aria-hidden=true href=#ç»ƒä¹ é¢˜>#</a></h3><ul><li><strong>ç»ƒä¹ :</strong> å¯¹ä»¥ä¸‹CFGæ‰§è¡Œ **Reaching Definition Analysisï¼Œ**ç»™å‡ºæœ€ç»ˆçš„$IN$å’Œ$OUT$</li></ul><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/%E6%88%AA%E5%B1%8F2022-01-03_%E4%B8%8B%E5%8D%8810.59.42.png alt="æˆªå±2022-01-03 ä¸‹åˆ10.59.42.png" style=zoom:50%><h3 id=understanding-the-why-the-loop-will-definitely-stop-ç†è§£ç®—æ³•çš„æ”¶æ•›æ€§>Understanding the why the loop will definitely stop ï¼ˆç†è§£ç®—æ³•çš„æ”¶æ•›æ€§ï¼‰<a hidden class=anchor aria-hidden=true href=#understanding-the-why-the-loop-will-definitely-stop-ç†è§£ç®—æ³•çš„æ”¶æ•›æ€§>#</a></h3><ul><li><p>$gen_s$ å’Œ $kill_s$ æ˜¯å¸¸é‡</p></li><li><p>$IN[s]$ æ¯æ¬¡å¢åŠ çš„<strong>å› å­factor</strong>ï¼ˆè¿™é‡ŒæŒ‡<strong>Definition</strong>ï¼‰è¦ä¹ˆè¢«$kill_s$ è¦ä¹ˆè¢«å¸¦å…¥$OUT[s]$</p></li></ul><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_06A792AB1F78-1.jpeg alt=IMG_06A792AB1F78-1.jpeg style=zoom:50%><ul><li>äºæ˜¯$OUT[s]=f_s(IN[s])$ å•è°ƒä¸å‡ ($OUT[s]$è¦ä¹ˆ0â†’1ï¼Œ è¦ä¹ˆ 1â†’1 )</li><li>åˆç”±äºfactoræœ¬èº«æ˜¯<strong>æœ‰é™çš„</strong> i.e. OUT[s]æœ€å¤šå˜æˆ 1111&mldr;1111 å°±ä¸å˜äº†ã€‚</li><li>ç±»æ¯”ä¸€ä¸‹æ•°åˆ—çš„å•è°ƒæœ‰ç•Œå‡†åˆ™ã€‚</li></ul><h3 id=understanding-the-safe-approximation-ç†è§£ç®—æ³•å®‰å…¨è¿‘ä¼¼æ€§>Understanding the safe-approximation ï¼ˆç†è§£ç®—æ³•å®‰å…¨è¿‘ä¼¼æ€§ï¼‰<a hidden class=anchor aria-hidden=true href=#understanding-the-safe-approximation-ç†è§£ç®—æ³•å®‰å…¨è¿‘ä¼¼æ€§>#</a></h3><ul><li><p>å½“$OUT[s]$ä¸å†å˜åŒ–æ—¶ï¼Œ$IN[s]$æ˜¯å¦ä¼šå†æ¬¡å˜åŒ–ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯<strong>ä¸ä¼š</strong>ï¼Œç”±äº</p><p>$IN[B] = \bigcup_{P\ a\ predecessor \ of\ B} OUT[P]$</p><p>æ‰€æœ‰çš„$IN[B]$ å–å†³äº $OUT[P]$ çš„å€¼ï¼Œäºæ˜¯$IN[B]$çš„å€¼ä¸å˜ã€‚</p><p>$OUT[B] = gen_B \cup (IN[B] - kill_B)$</p><p>äºæ˜¯æ‰€æœ‰çš„ $OUT[s]$ä¹Ÿä¸ä¼šæ”¹å˜ã€‚</p></li></ul><p>ç»ƒä¹ ï¼šå¯¹ä»¥ä¸‹CFGï¼Œåˆ©ç”¨Reaching Definition Analysisï¼Œè®¡ç®—å„ä¸ªBBæœ€ç»ˆçš„$IN$å’Œ$OUT$</p><hr><h2 id=live-variable-analysis>Live Variable Analysis<a hidden class=anchor aria-hidden=true href=#live-variable-analysis>#</a></h2><h3 id=definition><strong>Definition:</strong><a hidden class=anchor aria-hidden=true href=#definition>#</a></h3><blockquote><p>Live variable analysis tells whether the value of variable $v$ at program point $p$ could be used along some path in CFG starting at $p$. If so, $v$ is live at $p$ï¼›otherwiseï¼Œ$v$ is dead at $p$.</p></blockquote><p>(è¿™ä¹Ÿæ„å‘³ç€ï¼š$v$ should not be redefined <strong>before usage</strong>)</p><ul><li>Applicationï¼š<ul><li><strong>Register Allocation (å¯„å­˜å™¨åˆ†é…ï¼‰</strong></li></ul></li></ul><h3 id=abstraction-1><strong>Abstraction</strong><a hidden class=anchor aria-hidden=true href=#abstraction-1>#</a></h3><ul><li>Data Flow Values/Facts<ul><li>All the <strong>variables</strong> in a program</li><li>Can be represented by <strong>bit vectors</strong><ul><li>0: dead 1: live</li></ul></li></ul></li></ul><h3 id=safe-approximation-1><strong>Safe-Approximation</strong><a hidden class=anchor aria-hidden=true href=#safe-approximation-1>#</a></h3><ul><li><p>why <strong>forward analysis</strong> is not appropriate for live variable analysis?</p><ul><li>Assume we use forward analysis strategy, information of using should be propagate backward whenever a statement use $v$ is reached, which costs a lot.</li><li>æˆ‘ä»¬åˆ©ç”¨åè¯æ³•çš„æ€æƒ³ï¼šå‡è®¾æˆ‘ä»¬ä½¿ç”¨å‰å‘åˆ†æï¼Œå˜é‡ä½¿ç”¨çš„ä¿¡æ¯å°†ä¼šè¢«å‘åä¼ æ’­ï¼Œé‚£è¿˜ä¸å¦‚ç›´æ¥è¿›è¡Œåå‘åˆ†ææ¥çš„æ–¹ä¾¿ã€‚</li></ul></li><li><p>According to the definition, the live variable should be a may analysis.</p></li><li><p><strong>understand the term â€˜liveâ€™:</strong> determine whether the variable $v$ in some register $R$ is live, or should we delete the value of $v$ in $R$, at the point of $IN[B]$?</p><p>If Yes, $IN[B] = {v}$ else $IN[B] = {}$</p></li></ul><p>ç”±äºæ˜¯may analysisï¼Œ<strong>Control Flow</strong>é€šè¿‡ä»¥ä¸‹å¼å­ç»™å‡º</p><p>$$
OUT[B] = \bigcup_{S\ is\ a successor\ of\ B} IN[S]
$$</p><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/IMG_1276.jpg alt=IMG_1276.jpg style=zoom:50%><ul><li><p><strong>ç›²äººæ‘¸è±¡</strong>ï¼šæˆ‘ä»¬é€šè¿‡ä»¥ä¸‹ä¸€ç»„ç»ƒä¹ ï¼Œæ¢ç´¢æ‰€æœ‰Bå…³äº$v$çš„è¡¨è¾¾å¼ä¹‹æƒ…å†µï¼Œæ¥æ¢ç´¢å‡º Transfer Function</p><p>ç»ƒä¹ ï¼šæ ¹æ®ä¸Šå›¾çš„CFGï¼Œå¹¶ç»™å®š$OUT[B] = {v}$ï¼Œè€ƒè™‘ä»¥ä¸‹$B$çš„è¡¨è¾¾å¼å¯¹åº”çš„$IN[B]$</p><ol><li><code>k = n</code> 2. <code>k = v</code> 3. <code>v = v - 1</code> 4. <code>v = 2; k = v</code> 5. <code>k = v; v = 2</code> 6. <code>v = 2</code></li></ol></li><li><p>*ç­”æ¡ˆï¼š</p><ol><li><code>k = n</code>: ç”±äºæ²¡æœ‰æ¶‰åŠåˆ°$v$ï¼Œæ ¹æ®åŸåˆ™ï¼Œå¯„å­˜å™¨$R$ä¸åº”åˆ å»$v$çš„å€¼ï¼Œå› æ­¤$IN[B] = {v}$</li><li><code>k = v</code> : ç”±äºæ¶‰åŠåˆ°use $v$ï¼Œæˆ‘ä»¬ä¸åº”è¯¥åˆ å»$v$çš„å€¼ï¼Œå› æ­¤$IN[B] = {v}$</li><li><code>v = v - 1</code> : è¿™é¢˜çœ‹ä¼¼æ˜¯å¯¹ $v$è¿›è¡Œäº†æ–°çš„å®šä¹‰ï¼Œä½†æ˜¯å°±è¯­ä¹‰è€Œè¨€ï¼Œå°†ä¼šå…ˆå¯¹$v$çš„æ—§å€¼è¿›è¡Œè¯»å–ï¼Œäºæ˜¯æˆ‘ä»¬æ²¡æœ‰å¿…è¦ kill æ‰$v$ï¼Œå› æ­¤ $IN[B] = {v}$</li><li><code>v = 2; k = v</code> ï¼šè¿™é¢˜çœ‹ä¼¼ä½¿ç”¨äº† $v$ï¼Œä½†æ˜¯å…ˆkillæ‰äº†$v$çš„å®šä¹‰ï¼Œå› æ­¤ $IN[B] = {}$</li><li><code>k = v; v = 2</code> ï¼š*æ­£å¥½ä¸ä¸Šé¢˜ç›¸åï¼Œå…ˆå¯¹$v$è¿›è¡Œäº†useï¼Œå› æ­¤$IN[B] = {v}$</li><li><code>v = 2</code> ï¼š$v$è¢«killæ‰ï¼Œæ˜¾ç„¶ $IN[b] = {v}$</li></ol></li><li><p>å…ˆæ¥å›ç­”é›†åˆä¸­é‚£äº›<strong>å¢å‡</strong>çš„é‡</p><ul><li>$use_B$ï¼šé›†åˆä¸­åœ¨<strong>ä»»ä½•useå…ˆäºdefine</strong>çš„å˜é‡é›†åˆã€‚</li><li>$def_B$ï¼šé›†åˆä¸­<strong>ä»»ä½•defineå…ˆäºuse</strong>çš„å˜é‡é›†åˆã€‚</li></ul></li><li><p>äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ‘¸ç´¢å‡ºä¸€ä¸ª <strong>Transfer Function</strong></p><p>$$
IN[B] = use_B \cup(OUT[B]-def_B)
$$</p></li><li><p>æ€è€ƒï¼škill $def_B$ å’Œ union $use_B$ çš„é¡ºåºæ˜¯å¦å½±å“ç®—æ³•çš„æ­£ç¡®æ€§ï¼Ÿ</p><p>ç»“è®ºï¼šä¸å½±å“ï¼Œç›´è§‰ä¸Šæ¥çœ‹ï¼Œæ ¹æ®$def_B$å’Œ$use_B$çš„å®šä¹‰ï¼Œ$def_B \cap use_b = \phi$</p><p>ä¸å¤±ä¸¥è°¨åœ°ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜è¿™ä¸ªæ€§è´¨ï¼š</p><p>ã€æ¨è®ºã€‘</p><p>å·²çŸ¥ $def_B \cap use_b = \phi$ï¼Œ $IN[B] = use_B \cup(OUT[B]-def_B) = (OUT[B] \cup use_B) - def_B$ æˆç«‹</p><p>ã€è¯æ˜ã€‘</p><p>è€ƒè™‘é›†åˆè¿ç®—å…¬å¼ï¼š $(B-A) \cup C = (B\cup C) - (A - C)$</p><p>æˆ‘ä»¬æœ‰ï¼š</p><p>$$
IN[B] = use_B \cup(OUT[B]-def_B) = (use_B \cup OUT[B]) - (def_B - use_B)
$$</p><p>ç”±äº $def_B \cap use_b = \phi$ï¼Œäºæ˜¯æœ‰$def_B-use_B =def_B$</p><p>é‚£ä¹ˆï¼Œ</p><p>$$
(use_B \cup OUT[B]) - (def_B - use_B)=(use_B \cup OUT[B]) - def_B
$$</p><p>$\blacksquare$</p></li></ul><h3 id=algorithm>Algorithm<a hidden class=anchor aria-hidden=true href=#algorithm>#</a></h3><p>æŒ‰ç…§Reaching Definition Analysisçš„æ¡†æ¶ï¼Œä¸éš¾å¾—åˆ°ã€‚ä½†æ˜¯æœ‰ä¸€ç‚¹ä¸åŒï¼š</p><p>ç”±äºæ˜¯BackWard Analysisï¼Œä»ExitèŠ‚ç‚¹å¼€å§‹éå†ã€‚</p><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/live_var.png alt="live variable algorithm"><h3 id=ç»ƒä¹ é¢˜-1>ç»ƒä¹ é¢˜<a hidden class=anchor aria-hidden=true href=#ç»ƒä¹ é¢˜-1>#</a></h3><ul><li><strong>ç»ƒä¹ :</strong> å¯¹ä»¥ä¸‹CFGæ‰§è¡Œ **Reaching Definition Analysisï¼Œ**ç»™å‡ºæœ€ç»ˆçš„$IN$å’Œ$OUT$</li></ul><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/%E6%88%AA%E5%B1%8F2022-01-03_%E4%B8%8B%E5%8D%8811.28.34.png alt="æˆªå±2022-01-03 ä¸‹åˆ11.28.34.png" style=zoom:50%><hr><h2 id=available-expression-analysis>Available Expression Analysis<a hidden class=anchor aria-hidden=true href=#available-expression-analysis>#</a></h2><h3 id=definition-1>Definition<a hidden class=anchor aria-hidden=true href=#definition-1>#</a></h3><p><strong>Available:</strong></p><p>An expression <code>x op y</code> is <strong>available</strong> at program point $p$ if</p><ol><li>All paths from the entry to p must pass through the evaluation of <code>x op y</code></li><li>After the last evaluation of x op y, there is <strong>no redefinition</strong> of <code>x</code> or <code>y</code></li></ol><p><strong>Explanation:</strong></p><ul><li>è¿™é‡Œçš„redefinitionè¡¨æ˜ï¼šåŸæœ¬çš„ç»“æœå¤±æ•ˆï¼Œæˆ‘ä»¬å¯ä»¥éœ€è¦æ›´æ”¹ <code>x op y</code> çš„ç»“æœå€¼</li><li>available expressionçš„ä¿¡æ¯å¯ä»¥ç”¨äºæ£€æŸ¥å…¨å±€ç›¸åŒçš„å­è¡¨è¾¾å¼<ul><li>æ¯”å¦‚ï¼Œåœ¨æŸå‡ ä¸ªBBä¸­è¡¨è¾¾å¼çš„å€¼ä¸å˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ å»é‚£ä¸ªè¡¨è¾¾å¼ï¼Œç›´æ¥å°†ç¼“å­˜çš„ç»“æœèµ‹ç»™å˜é‡ï¼Œ<strong>ä¼˜åŒ–æ‰</strong>é‡å¤è®¡ç®—ã€‚</li></ul></li></ul><h3 id=abstraction-2>Abstraction<a hidden class=anchor aria-hidden=true href=#abstraction-2>#</a></h3><ul><li>All the expressions in a program</li><li>Also represented by Bit Vectors</li></ul><h3 id=safe-approximation-2>Safe-Approximation<a hidden class=anchor aria-hidden=true href=#safe-approximation-2>#</a></h3><p>æ³¨ï¼š</p><ol><li>As the definition illustrated, the available expression analysis ought to be a <strong>MUST ANALYSIS.</strong></li><li>As we are analyzing expression in all control flows, <strong>forward analysis</strong> is preferred to bring the information.</li></ol><p><strong>Transfer Function</strong></p><p>$gen_B$: Any expression included by $B$ to be involved.</p><p>$kill_B$: Any expression contains variables redefined in $B$ to be excluded.</p><p>æˆ‘ä»¬å¯ä»¥å¾—åˆ°Transfer Functionï¼š</p><p>$$
OUT[B] = gen_B \cup (IN[B]-kill_B)
$$</p><p><strong>Control Flows</strong></p><p>For it is a must analysis, control flow ought to defined by:</p><p>$$
IN[B] = \bigcap_{P\ predecessor\ of\ B } OUT[P]
$$</p><h3 id=algorithm-1>Algorithm<a hidden class=anchor aria-hidden=true href=#algorithm-1>#</a></h3><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/available_exp.png alt="available expression algorithm"><ul><li><strong>ç»ƒä¹ :</strong> å¯¹ä»¥ä¸‹CFGæ‰§è¡Œ **Reaching Definition Analysisï¼Œ**ç»™å‡ºæœ€ç»ˆçš„$IN$å’Œ$OUT$</li></ul><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/%E6%88%AA%E5%B1%8F2022-01-04_%E4%B8%8B%E5%8D%882.09.17.png alt="æˆªå±2022-01-04 ä¸‹åˆ2.09.17.png" style=zoom:50%><hr><h3 id=comparison-for-three-data-flow-analysis>Comparison for three data flow analysis<a hidden class=anchor aria-hidden=true href=#comparison-for-three-data-flow-analysis>#</a></h3><p><strong>ç»ƒä¹ </strong>ï¼šæ ¹æ®ä»¥ä¸Šçš„å†…å®¹ï¼Œå¡«å†™ä¸‹è¡¨ï¼ˆä¸è¦å‚è€ƒä¸Šé¢çš„ææ–™ï¼‰</p><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/%E6%88%AA%E5%B1%8F2022-01-04_%E4%B8%8B%E5%8D%882.13.06.png alt="æˆªå±2022-01-04 ä¸‹åˆ2.13.06.png" style=zoom:50%><ul><li>ç­”æ¡ˆï¼š</li></ul><img src=http://jiayezheng.tech//posts/compilers/static-analysis/data-flow-analysis/images/%E6%88%AA%E5%B1%8F2022-01-04_%E4%B8%8B%E5%8D%882.19.11.png alt="æˆªå±2022-01-04 ä¸‹åˆ2.19.11.png" style=zoom:50%></div><footer class=post-footer><ul class=post-tags><li><a href=http://jiayezheng.tech/tags/static-analysis/>static analysis</a></li></ul><nav class=paginav><a class=prev href=http://jiayezheng.tech/posts/compilers/static-analysis/data-flow-analysis/data-flow-analysis-foundations/><span class=title>Â« Prev Page</span><br><span>ã€è½¯ä»¶åˆ†æç¬”è®°ã€‘æ•°æ®æµåˆ†æï¼šåŸºç¡€ä¸åŸç†ç¯‡</span></a>
<a class=next href=http://jiayezheng.tech/posts/leetcode/miscs/390/><span class=title>Next Page Â»</span><br><span>LC390.æ¶ˆé™¤æ¸¸æˆ</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2022 <a href=http://jiayezheng.tech/>åå£°ï¼Œåªæ˜¯ä¸€ç§ç³Ÿç³•çš„é”™è§‰</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>